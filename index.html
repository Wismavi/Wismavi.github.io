<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –ø–æ –ö–∞–≤–∫–∞–∑—É</title>
  <script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU&apikey=9909b22a-a587-4ce4-8441-8db1aed26405" type="text/javascript"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: Arial, sans-serif;
    }

    body {
      display: flex;
      flex-direction: row;
      height: 100vh;
    }

    /* –ö–∞—Ä—Ç–∞ */
    #map {
      flex: 2;
      min-height: 300px;
    }

    /* –°–∞–π–¥–±–∞—Ä */
    #sidebar {
      flex: 1;
      display: flex;
      flex-direction: column;
      background: #f9f9f9;
      border-left: 1px solid #ccc;
      min-width: 250px;
    }

    /* –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä */
    #progress {
      height: 20px;
      background: #eee;
      border-bottom: 1px solid #ccc;
      position: relative;
    }
    #progress-bar {
      height: 100%;
      width: 0;
      background: #0078ff;
      transition: width 0.5s;
    }
    #progress-label {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      font-size: 12px;
      color: #333;
    }

    #gallery {
      flex: 1;
      padding: 10px;
      overflow-y: auto;
    }

    .photo-card {
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      padding: 10px;
      margin-bottom: 15px;
    }

    .photo-card img {
      max-width: 100%;
      border-radius: 6px;
      margin-bottom: 8px;
    }

    .photo-card h3 {
      margin: 0 0 5px;
      font-size: 16px;
      color: #0078ff;
    }

    .photo-card p {
      margin: 0;
      font-size: 13px;
      color: #555;
      line-height: 1.4;
    }

    #controls {
      display: flex;
      justify-content: space-between;
      padding: 10px;
      background: #fff;
      border-top: 1px solid #ccc;
    }

    #controls button {
      padding: 8px 16px;
      border: none;
      border-radius: 4px;
      background: #0078ff;
      color: white;
      cursor: pointer;
    }

    #controls button:hover {
      background: #005fcc;
    }

    /* üì± –ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è */
    @media (max-width: 768px) {
      body {
        flex-direction: column;
      }
      #map {
        flex: none;
        width: 100%;
        height: 50vh;
      }
      #sidebar {
        flex: none;
        width: 100%;
        height: 50vh;
        border-left: none;
        border-top: 1px solid #ccc;
      }
    }
  </style>
</head>
<body>
<div id="map"></div>
<div id="sidebar">
  <div id="progress">
    <div id="progress-bar"></div>
    <div id="progress-label">0%</div>
  </div>
  <div id="gallery"></div>
  <div id="controls">
    <button id="prevBtn">‚üµ –ù–∞–∑–∞–¥</button>
    <button id="nextBtn">–î–∞–ª–µ–µ ‚ü∂</button>
  </div>
</div>

<script>
  ymaps.ready(init);

  function init(){
    const map = new ymaps.Map("map", {
      center: [44.0, 43.0],
      zoom: 9
    });

    const cities = [
  {
    name: "–ö–∏—Å–ª–æ–≤–æ–¥—Å–∫",
    coords: [43.9056, 42.7208],
    photos: [
      { 
        url: "kislovodsk1.jpg", 
        title: "–ù–∞—Ä–∑–∞–Ω–Ω–∞—è –≥–∞–ª–µ—Ä–µ—è", 
        description: "–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–µ –∑–¥–∞–Ω–∏–µ XIX –≤–µ–∫–∞, –≥–¥–µ –º–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Ü–µ–ª–µ–±–Ω—ã–µ –º–∏–Ω–µ—Ä–∞–ª—å–Ω—ã–µ –≤–æ–¥—ã." 
      },
      { 
        url: "kislovodsk2.jpg", 
        title: "–°—Ü–µ–Ω–∞-—Ä–∞–∫–æ–≤–∏–Ω–∞", 
        description: "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å –ö—É—Ä–æ—Ä—Ç–Ω–æ–≥–æ –ø–∞—Ä–∫–∞, –º–µ—Å—Ç–æ –¥–ª—è –∫–æ–Ω—Ü–µ—Ä—Ç–æ–≤ –∏ –ø—Ä–æ–≥—É–ª–æ–∫." 
      },
      { 
        url: "kislovodsk3.jpg", 
        title: "–ö—É—Ä–æ—Ä—Ç–Ω—ã–π –ø–∞—Ä–∫", 
        description: "–û–¥–∏–Ω –∏–∑ –∫—Ä—É–ø–Ω–µ–π—à–∏—Ö –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–∞—Ä–∫–æ–≤ –ï–≤—Ä–æ–ø—ã, –∑–Ω–∞–º–µ–Ω–∏—Ç —Å–≤–æ–∏–º–∏ —Ç–µ—Ä—Ä–µ–Ω–∫—É—Ä–∞–º–∏." 
      },
      { 
        url: "kislovodsk4.jpg", 
        title: "–ö–∞–Ω–∞—Ç–Ω–∞—è –¥–æ—Ä–æ–≥–∞", 
        description: "–ü–æ–¥—ä–µ–º –Ω–∞ –≤–µ—Ä—à–∏–Ω—É –≥–æ—Ä—ã –ú–∞–ª–æ–µ –°–µ–¥–ª–æ —Å –ø–∞–Ω–æ—Ä–∞–º–Ω—ã–º –≤–∏–¥–æ–º –Ω–∞ –≥–æ—Ä–æ–¥ –∏ –ö–∞–≤–∫–∞–∑." 
      },
      { 
        url: "kislovodsk5.jpg", 
        title: "–í–∏–¥ –Ω–∞ –≠–ª—å–±—Ä—É—Å", 
        description: "–ò–∑ –≥–æ—Ä–æ–¥–∞ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è –ø–æ—Ç—Ä—è—Å–∞—é—â–∏–µ –≤–∏–¥—ã –Ω–∞ –≤—ã—Å–æ—á–∞–π—à—É—é –≤–µ—Ä—à–∏–Ω—É –ï–≤—Ä–æ–ø—ã." 
      },
      { 
        url: "kislovodsk6.jpg", 
        title: "–ú–µ–¥–æ–≤—ã–µ –≤–æ–¥–æ–ø–∞–¥—ã", 
        description: "–ñ–∏–≤–æ–ø–∏—Å–Ω—ã–π –∫–∞—Å–∫–∞–¥ –≤–æ–¥–æ–ø–∞–¥–æ–≤ –≤ –æ–∫—Ä–µ—Å—Ç–Ω–æ—Å—Ç—è—Ö –≥–æ—Ä–æ–¥–∞." 
      }
    ]
  },
  {
    name: "–ï—Å—Å–µ–Ω—Ç—É–∫–∏",
    coords: [44.0444, 42.8589],
    photos: [
      { 
        url: "essentuki1.jpg", 
        title: "–ü–∏—Ç—å–µ–≤–∞—è –≥–∞–ª–µ—Ä–µ—è", 
        description: "–ú–µ—Å—Ç–æ, –≥–¥–µ –º–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∑–Ω–∞–º–µ–Ω–∏—Ç—ã–µ –º–∏–Ω–µ—Ä–∞–ª—å–Ω—ã–µ –≤–æ–¥—ã –ï—Å—Å–µ–Ω—Ç—É–∫–æ–≤." 
      }
    ]
  },
  {
    name: "–ü—è—Ç–∏–≥–æ—Ä—Å–∫",
    coords: [44.0486, 43.0594],
    photos: [
      { 
        url: "pyatigorsk1.jpg", 
        title: "–û–∑–µ—Ä–æ –ü—Ä–æ–≤–∞–ª", 
        description: "–ö–∞—Ä—Å—Ç–æ–≤–æ–µ –æ–∑–µ—Ä–æ –≤ –≥—Ä–æ—Ç–µ, –≤–æ—Å–ø–µ—Ç–æ–µ –ú.–Æ. –õ–µ—Ä–º–æ–Ω—Ç–æ–≤—ã–º." 
      },
      { 
        url: "pyatigorsk2.jpg", 
        title: "–ü–∞—Ä–∫ –¶–≤–µ—Ç–Ω–∏–∫", 
        description: "–°—Ç–∞—Ä–µ–π—à–∏–π –ø–∞—Ä–∫ –≥–æ—Ä–æ–¥–∞ —Å –∫—Ä–∞—Å–∏–≤—ã–º–∏ –∫–ª—É–º–±–∞–º–∏ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–º–∏ –ø–∞–º—è—Ç–Ω–∏–∫–∞–º–∏." 
      },
      { 
        url: "pyatigorsk3.jpg", 
        title: "–ú–µ—Å—Ç–æ –¥—É—ç–ª–∏ –õ–µ—Ä–º–æ–Ω—Ç–æ–≤–∞", 
        description: "–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–µ –º–µ—Å—Ç–æ, –≥–¥–µ –ø–æ–≥–∏–± –≤–µ–ª–∏–∫–∏–π —Ä—É—Å—Å–∫–∏–π –ø–æ—ç—Ç." 
      },
      { 
        url: "pyatigorsk4.jpg", 
        title: "–ë–µ—Å–µ–¥–∫–∞ ¬´–≠–æ–ª–æ–≤–∞ –ê—Ä—Ñ–∞¬ª", 
        description: "–†–æ–º–∞–Ω—Ç–∏—á–Ω–∞—è –±–µ—Å–µ–¥–∫–∞ —Å –≤–∏–¥–æ–º –Ω–∞ –≥–æ—Ä–æ–¥ –∏ –ö–∞–≤–∫–∞–∑—Å–∫–∏–µ –≥–æ—Ä—ã." 
      }
    ]
  },
  {
    name: "–ñ–µ–ª–µ–∑–Ω–æ–≤–æ–¥—Å–∫",
    coords: [44.1399, 43.0307],
    photos: [
      { 
        url: "zheleznovodsk1.jpg", 
        title: "–ö–∞—Å–∫–∞–¥–Ω–∞—è –ª–µ—Å—Ç–Ω–∏—Ü–∞", 
        description: "–ì–ª–∞–≤–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —Å–æ–µ–¥–∏–Ω—è—é—â–∞—è –ø–∞—Ä–∫ —Å —Ü–µ–Ω—Ç—Ä–æ–º." 
      },
      { 
        url: "zheleznovodsk2.jpg", 
        title: "–ö—É—Ä–æ—Ä—Ç–Ω–æ–µ –æ–∑–µ—Ä–æ", 
        description: "–ü–æ–ø—É–ª—è—Ä–Ω–æ–µ –º–µ—Å—Ç–æ –æ—Ç–¥—ã—Ö–∞ —Å –ø–ª—è–∂–µ–º –∏ –ø—Ä–æ–≥—É–ª–æ—á–Ω—ã–º–∏ –¥–æ—Ä–æ–∂–∫–∞–º–∏." 
      }
    ]
  },
  {
    name: "–ú–∏–Ω–µ—Ä–∞–ª—å–Ω—ã–µ –í–æ–¥—ã",
    coords: [44.2103, 43.1353],
    photos: [
      { 
        url: "minvody1.jpg", 
        title: "–ñ/–¥ –≤–æ–∫–∑–∞–ª", 
        description: "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –≤–∏–∑–∏—Ç–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –≥–æ—Ä–æ–¥–∞, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –≤ —Å–æ–≤–µ—Ç—Å–∫–æ–µ –≤—Ä–µ–º—è." 
      },
      { 
        url: "minvody2.jpg", 
        title: "–ê—ç—Ä–æ–ø–æ—Ä—Ç", 
        description: "–ö—Ä—É–ø–Ω–µ–π—à–∏–π –∞–≤–∏–∞—É–∑–µ–ª —Ä–µ–≥–∏–æ–Ω–∞, –≤–æ—Ä–æ—Ç–∞ –Ω–∞ –ö–∞–≤–∫–∞–∑." 
      }
    ]
  }
];


    // –õ–∏–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–∞
    const routeCoords = cities.map(city => city.coords);
    const polyline = new ymaps.Polyline(routeCoords, {}, {
      strokeColor: "#0078FF",
      strokeWidth: 4,
      strokeOpacity: 0.8
    });
    map.geoObjects.add(polyline);

    // –ú–µ—Ç–∫–∏ –≥–æ—Ä–æ–¥–æ–≤
    cities.forEach((city, index) => {
      const placemark = new ymaps.Placemark(city.coords, {
        balloonContent: `<strong>${city.name}</strong>`
      });
      placemark.events.add("click", () => {
        currentIndex = index;
        showCity(currentIndex);
      });
      map.geoObjects.add(placemark);
    });

    // –ö—Ä–∞—Å–Ω–∞—è —Ç–æ—á–∫–∞-–ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫
    const traveler = new ymaps.Placemark(routeCoords[0], {}, {
      iconLayout: 'default#image',
      iconImageHref: 'https://img.icons8.com/ios-filled/50/fa314a/filled-circle.png',
      iconImageSize: [12, 12],
      iconImageOffset: [-6, -6]
    });
    map.geoObjects.add(traveler);

    // –°–ª–µ–¥—ã –ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞
    const visitedMarks = [];

    function moveTraveler(index) {
      const coords = cities[index].coords;
      traveler.geometry.setCoordinates(coords);

      // –î–æ–±–∞–≤–ª—è–µ–º —Å–ª–µ–¥
      const visited = new ymaps.Placemark(coords, {}, {
        iconLayout: 'default#image',
        iconImageHref: 'https://img.icons8.com/ios-filled/50/fa314a/filled-circle.png',
        iconImageSize: [6, 6],
        iconImageOffset: [-3, -3]
      });
      map.geoObjects.add(visited);
      visitedMarks.push(visited);
    }

    // –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º –∫–∞—Ä—Ç—É
    map.setBounds(polyline.geometry.getBounds(), { checkZoomRange: true, zoomMargin: 50 });

    // –ì–∞–ª–µ—Ä–µ—è
    let currentIndex = 0;

    function showCity(index) {
      const city = cities[index];
      map.setCenter(city.coords, 13);

      moveTraveler(index); // –¥–≤–∏–≥–∞–µ–º —Ç–æ—á–∫—É –∏ –æ—Å—Ç–∞–≤–ª—è–µ–º —Å–ª–µ–¥

      const gallery = document.getElementById("gallery");
      gallery.innerHTML = `<h2>${city.name}</h2>`;

      city.photos.forEach(photo => {
        const card = document.createElement("div");
        card.className = "photo-card";

        const img = document.createElement("img");
        img.src = photo.url;

        const title = document.createElement("h3");
        title.textContent = photo.title;

        const desc = document.createElement("p");
        desc.textContent = photo.description;

        card.appendChild(img);
        card.appendChild(title);
        card.appendChild(desc);

        gallery.appendChild(card);
      });

      updateProgress(index);
    }

    // –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä
    function updateProgress(index) {
      const progress = ((index + 1) / cities.length) * 100;
      document.getElementById("progress-bar").style.width = progress + "%";
      document.getElementById("progress-label").textContent = `${index + 1} / ${cities.length}`;
    }

    // –ö–Ω–æ–ø–∫–∏
    document.getElementById("nextBtn").onclick = () => {
      currentIndex = (currentIndex + 1) % cities.length;
      showCity(currentIndex);
    };

    document.getElementById("prevBtn").onclick = () => {
      currentIndex = (currentIndex - 1 + cities.length) % cities.length;
      showCity(currentIndex);
    };

    // –ü–µ—Ä–≤—ã–π –≥–æ—Ä–æ–¥
    showCity(currentIndex);
  }
</script>
</body>
</html>
